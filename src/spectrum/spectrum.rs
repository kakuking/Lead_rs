use derive_more::{Index, IndexMut};

pub trait CoefficientSpectrum<const N: usize>: Index<usize> + IndexMut<usize> {
    fn c(&self) -> [f64; N];
    fn n_samples() -> usize;

    fn init_one(v: f64) -> Self;
    fn init_copy(s: &Self) -> Self;
    
    fn equals(&self, o: &Self) -> bool;
    fn to_string(&self) -> String;
    fn add_assign(&mut self, s: &Self);
    fn sub_assign(&mut self, s: &Self);
    fn mul_assign(&mut self, o: &Self);
    fn mul_assign_one(&mut self, o: f64);
    fn div_assign(&mut self, o: &Self);
    fn div_assign_one(&mut self, o: f64);

    fn add(o1: &Self, o2: &Self) -> Self;
    fn sub(o1: &Self, o2: &Self) -> Self;
    fn div(o1: &Self, o2: &Self) -> Self;
    fn mul(o1: &Self, o2: &Self) -> Self;
    fn div_one(o1: &Self, o2: f64) -> Self;
    fn mul_one(o1: &Self, o2: f64) -> Self;

    fn sqrt(&self) -> Self;
    fn pow(&self, power: f64) -> Self;
    fn exp(&self) -> Self;
    fn clamp(&self, low: f64, high: f64) -> Self;
    fn has_nan(&self) -> bool;
    fn lerp(t: f64, a: &Self, b: &Self) -> Self;

    fn interpolate_spectrum_samples(lambda: &Vec<f64>, vals: &Vec<f64>, l: f64) -> f64 {
        let n = lambda.len();
        if l <= lambda[0] {
            return vals[0];
        }
        if l >= lambda[n - 1] {
            return vals[n - 1];
        }
    
        let offset = Self::find_interval(n, |index| lambda[index] <= l);
        let t = (l - lambda[offset]) / (lambda[offset + 1] - lambda[offset]);
        vals[offset] +  t * (vals[offset + 1] - vals[offset])
    }

    fn find_interval<F>(n: usize, pred: F) -> usize
    where
        F: Fn(usize) -> bool,
    {
        let mut lower = 0;
        let mut upper = n;
        while upper - lower > 1 {
            let mid = (lower + upper) / 2;
            if pred(mid) {
                lower = mid;
            } else {
                upper = mid;
            }
        }
        lower
    }
}

pub enum SpectrumType {
    Reflectance, 
    Illuminant
}

pub const N_CIE_SAMPLES: usize = 471;
pub const CIE_Y_INTEGRAL: f64 = 106.856895f64;
pub const CIE_X: [f64; N_CIE_SAMPLES] = [0.0001299000f64,   0.0001458470f64,   0.0001638021f64,   0.0001840037f64,
                                    0.0002066902f64,   0.0002321000f64,   0.0002607280f64,   0.0002930750f64,
                                    0.0003293880f64,   0.0003699140f64,   0.0004149000f64,   0.0004641587f64,
                                    0.0005189860f64,   0.0005818540f64,   0.0006552347f64,   0.0007416000f64,
                                    0.0008450296f64,   0.0009645268f64,   0.001094949f64,    0.001231154f64,
                                    0.001368000f64,    0.001502050f64,    0.001642328f64,    0.001802382f64,
                                    0.001995757f64,    0.002236000f64,    0.002535385f64,    0.002892603f64,
                                    0.003300829f64,    0.003753236f64,    0.004243000f64,    0.004762389f64,
                                    0.005330048f64,    0.005978712f64,    0.006741117f64,    0.007650000f64,
                                    0.008751373f64,    0.01002888f64,     0.01142170f64,     0.01286901f64,
                                    0.01431000f64,     0.01570443f64,     0.01714744f64,     0.01878122f64,
                                    0.02074801f64,     0.02319000f64,     0.02620736f64,     0.02978248f64,
                                    0.03388092f64,     0.03846824f64,     0.04351000f64,     0.04899560f64,
                                    0.05502260f64,     0.06171880f64,     0.06921200f64,     0.07763000f64,
                                    0.08695811f64,     0.09717672f64,     0.1084063f64,      0.1207672f64,
                                    0.1343800f64,      0.1493582f64,      0.1653957f64,      0.1819831f64,
                                    0.1986110f64,      0.2147700f64,      0.2301868f64,      0.2448797f64,
                                    0.2587773f64,      0.2718079f64,      0.2839000f64,      0.2949438f64,
                                    0.3048965f64,      0.3137873f64,      0.3216454f64,      0.3285000f64,
                                    0.3343513f64,      0.3392101f64,      0.3431213f64,      0.3461296f64,
                                    0.3482800f64,      0.3495999f64,      0.3501474f64,      0.3500130f64,
                                    0.3492870f64,      0.3480600f64,      0.3463733f64,      0.3442624f64,
                                    0.3418088f64,      0.3390941f64,      0.3362000f64,      0.3331977f64,
                                    0.3300411f64,      0.3266357f64,      0.3228868f64,      0.3187000f64,
                                    0.3140251f64,      0.3088840f64,      0.3032904f64,      0.2972579f64,
                                    0.2908000f64,      0.2839701f64,      0.2767214f64,      0.2689178f64,
                                    0.2604227f64,      0.2511000f64,      0.2408475f64,      0.2298512f64,
                                    0.2184072f64,      0.2068115f64,      0.1953600f64,      0.1842136f64,
                                    0.1733273f64,      0.1626881f64,      0.1522833f64,      0.1421000f64,
                                    0.1321786f64,      0.1225696f64,      0.1132752f64,      0.1042979f64,
                                    0.09564000f64,     0.08729955f64,     0.07930804f64,     0.07171776f64,
                                    0.06458099f64,     0.05795001f64,     0.05186211f64,     0.04628152f64,
                                    0.04115088f64,     0.03641283f64,     0.03201000f64,     0.02791720f64,
                                    0.02414440f64,     0.02068700f64,     0.01754040f64,     0.01470000f64,
                                    0.01216179f64,     0.009919960f64,    0.007967240f64,    0.006296346f64,
                                    0.004900000f64,    0.003777173f64,    0.002945320f64,    0.002424880f64,
                                    0.002236293f64,    0.002400000f64,    0.002925520f64,    0.003836560f64,
                                    0.005174840f64,    0.006982080f64,    0.009300000f64,    0.01214949f64,
                                    0.01553588f64,     0.01947752f64,     0.02399277f64,     0.02910000f64,
                                    0.03481485f64,     0.04112016f64,     0.04798504f64,     0.05537861f64,
                                    0.06327000f64,     0.07163501f64,     0.08046224f64,     0.08973996f64,
                                    0.09945645f64,     0.1096000f64,      0.1201674f64,      0.1311145f64,
                                    0.1423679f64,      0.1538542f64,      0.1655000f64,      0.1772571f64,
                                    0.1891400f64,      0.2011694f64,      0.2133658f64,      0.2257499f64,
                                    0.2383209f64,      0.2510668f64,      0.2639922f64,      0.2771017f64,
                                    0.2904000f64,      0.3038912f64,      0.3175726f64,      0.3314384f64,
                                    0.3454828f64,      0.3597000f64,      0.3740839f64,      0.3886396f64,
                                    0.4033784f64,      0.4183115f64,      0.4334499f64,      0.4487953f64,
                                    0.4643360f64,      0.4800640f64,      0.4959713f64,      0.5120501f64,
                                    0.5282959f64,      0.5446916f64,      0.5612094f64,      0.5778215f64,
                                    0.5945000f64,      0.6112209f64,      0.6279758f64,      0.6447602f64,
                                    0.6615697f64,      0.6784000f64,      0.6952392f64,      0.7120586f64,
                                    0.7288284f64,      0.7455188f64,      0.7621000f64,      0.7785432f64,
                                    0.7948256f64,      0.8109264f64,      0.8268248f64,      0.8425000f64,
                                    0.8579325f64,      0.8730816f64,      0.8878944f64,      0.9023181f64,
                                    0.9163000f64,      0.9297995f64,      0.9427984f64,      0.9552776f64,
                                    0.9672179f64,      0.9786000f64,      0.9893856f64,      0.9995488f64,
                                    1.0090892f64,      1.0180064f64,      1.0263000f64,      1.0339827f64,
                                    1.0409860f64,      1.0471880f64,      1.0524667f64,      1.0567000f64,
                                    1.0597944f64,      1.0617992f64,      1.0628068f64,      1.0629096f64,
                                    1.0622000f64,      1.0607352f64,      1.0584436f64,      1.0552244f64,
                                    1.0509768f64,      1.0456000f64,      1.0390369f64,      1.0313608f64,
                                    1.0226662f64,      1.0130477f64,      1.0026000f64,      0.9913675f64,
                                    0.9793314f64,      0.9664916f64,      0.9528479f64,      0.9384000f64,
                                    0.9231940f64,      0.9072440f64,      0.8905020f64,      0.8729200f64,
                                    0.8544499f64,      0.8350840f64,      0.8149460f64,      0.7941860f64,
                                    0.7729540f64,      0.7514000f64,      0.7295836f64,      0.7075888f64,
                                    0.6856022f64,      0.6638104f64,      0.6424000f64,      0.6215149f64,
                                    0.6011138f64,      0.5811052f64,      0.5613977f64,      0.5419000f64,
                                    0.5225995f64,      0.5035464f64,      0.4847436f64,      0.4661939f64,
                                    0.4479000f64,      0.4298613f64,      0.4120980f64,      0.3946440f64,
                                    0.3775333f64,      0.3608000f64,      0.3444563f64,      0.3285168f64,
                                    0.3130192f64,      0.2980011f64,      0.2835000f64,      0.2695448f64,
                                    0.2561184f64,      0.2431896f64,      0.2307272f64,      0.2187000f64,
                                    0.2070971f64,      0.1959232f64,      0.1851708f64,      0.1748323f64,
                                    0.1649000f64,      0.1553667f64,      0.1462300f64,      0.1374900f64,
                                    0.1291467f64,      0.1212000f64,      0.1136397f64,      0.1064650f64,
                                    0.09969044f64,     0.09333061f64,     0.08740000f64,     0.08190096f64,
                                    0.07680428f64,     0.07207712f64,     0.06768664f64,     0.06360000f64,
                                    0.05980685f64,     0.05628216f64,     0.05297104f64,     0.04981861f64,
                                    0.04677000f64,     0.04378405f64,     0.04087536f64,     0.03807264f64,
                                    0.03540461f64,     0.03290000f64,     0.03056419f64,     0.02838056f64,
                                    0.02634484f64,     0.02445275f64,     0.02270000f64,     0.02108429f64,
                                    0.01959988f64,     0.01823732f64,     0.01698717f64,     0.01584000f64,
                                    0.01479064f64,     0.01383132f64,     0.01294868f64,     0.01212920f64,
                                    0.01135916f64,     0.01062935f64,     0.009938846f64,    0.009288422f64,
                                    0.008678854f64,    0.008110916f64,    0.007582388f64,    0.007088746f64,
                                    0.006627313f64,    0.006195408f64,    0.005790346f64,    0.005409826f64,
                                    0.005052583f64,    0.004717512f64,    0.004403507f64,    0.004109457f64,
                                    0.003833913f64,    0.003575748f64,    0.003334342f64,    0.003109075f64,
                                    0.002899327f64,    0.002704348f64,    0.002523020f64,    0.002354168f64,
                                    0.002196616f64,    0.002049190f64,    0.001910960f64,    0.001781438f64,
                                    0.001660110f64,    0.001546459f64,    0.001439971f64,    0.001340042f64,
                                    0.001246275f64,    0.001158471f64,    0.001076430f64,    0.0009999493f64,
                                    0.0009287358f64,   0.0008624332f64,   0.0008007503f64,   0.0007433960f64,
                                    0.0006900786f64,   0.0006405156f64,   0.0005945021f64,   0.0005518646f64,
                                    0.0005124290f64,   0.0004760213f64,   0.0004424536f64,   0.0004115117f64,
                                    0.0003829814f64,   0.0003566491f64,   0.0003323011f64,   0.0003097586f64,
                                    0.0002888871f64,   0.0002695394f64,   0.0002515682f64,   0.0002348261f64,
                                    0.0002191710f64,   0.0002045258f64,   0.0001908405f64,   0.0001780654f64,
                                    0.0001661505f64,   0.0001550236f64,   0.0001446219f64,   0.0001349098f64,
                                    0.0001258520f64,   0.0001174130f64,   0.0001095515f64,   0.0001022245f64,
                                    0.00009539445f64,  0.00008902390f64,  0.00008307527f64,  0.00007751269f64,
                                    0.00007231304f64,  0.00006745778f64,  0.00006292844f64,  0.00005870652f64,
                                    0.00005477028f64,  0.00005109918f64,  0.00004767654f64,  0.00004448567f64,
                                    0.00004150994f64,  0.00003873324f64,  0.00003614203f64,  0.00003372352f64,
                                    0.00003146487f64,  0.00002935326f64,  0.00002737573f64,  0.00002552433f64,
                                    0.00002379376f64,  0.00002217870f64,  0.00002067383f64,  0.00001927226f64,
                                    0.00001796640f64,  0.00001674991f64,  0.00001561648f64,  0.00001455977f64,
                                    0.00001357387f64,  0.00001265436f64,  0.00001179723f64,  0.00001099844f64,
                                    0.00001025398f64,  0.000009559646f64, 0.000008912044f64, 0.000008308358f64,
                                    0.000007745769f64, 0.000007221456f64, 0.000006732475f64, 0.000006276423f64,
                                    0.000005851304f64, 0.000005455118f64, 0.000005085868f64, 0.000004741466f64,
                                    0.000004420236f64, 0.000004120783f64, 0.000003841716f64, 0.000003581652f64,
                                    0.000003339127f64, 0.000003112949f64, 0.000002902121f64, 0.000002705645f64,
                                    0.000002522525f64, 0.000002351726f64, 0.000002192415f64, 0.000002043902f64,
                                    0.000001905497f64, 0.000001776509f64, 0.000001656215f64, 0.000001544022f64,
                                    0.000001439440f64, 0.000001341977f64, 0.000001251141f64];
pub const CIE_Y: [f64; N_CIE_SAMPLES] = [0.000003917000f64,  0.000004393581f64,  0.000004929604f64,  0.000005532136f64,
0.000006208245f64,  0.000006965000f64,  0.000007813219f64,  0.000008767336f64,
0.000009839844f64,  0.00001104323f64,   0.00001239000f64,   0.00001388641f64,
0.00001555728f64,   0.00001744296f64,   0.00001958375f64,   0.00002202000f64,
0.00002483965f64,   0.00002804126f64,   0.00003153104f64,   0.00003521521f64,
0.00003900000f64,   0.00004282640f64,   0.00004691460f64,   0.00005158960f64,
0.00005717640f64,   0.00006400000f64,   0.00007234421f64,   0.00008221224f64,
0.00009350816f64,   0.0001061361f64,    0.0001200000f64,    0.0001349840f64,
0.0001514920f64,    0.0001702080f64,    0.0001918160f64,    0.0002170000f64,
0.0002469067f64,    0.0002812400f64,    0.0003185200f64,    0.0003572667f64,
0.0003960000f64,    0.0004337147f64,    0.0004730240f64,    0.0005178760f64,
0.0005722187f64,    0.0006400000f64,    0.0007245600f64,    0.0008255000f64,
0.0009411600f64,    0.001069880f64,     0.001210000f64,     0.001362091f64,
0.001530752f64,     0.001720368f64,     0.001935323f64,     0.002180000f64,
0.002454800f64,     0.002764000f64,     0.003117800f64,     0.003526400f64,
0.004000000f64,     0.004546240f64,     0.005159320f64,     0.005829280f64,
0.006546160f64,     0.007300000f64,     0.008086507f64,     0.008908720f64,
0.009767680f64,     0.01066443f64,      0.01160000f64,      0.01257317f64,
0.01358272f64,      0.01462968f64,      0.01571509f64,      0.01684000f64,
0.01800736f64,      0.01921448f64,      0.02045392f64,      0.02171824f64,
0.02300000f64,      0.02429461f64,      0.02561024f64,      0.02695857f64,
0.02835125f64,      0.02980000f64,      0.03131083f64,      0.03288368f64,
0.03452112f64,      0.03622571f64,      0.03800000f64,      0.03984667f64,
0.04176800f64,      0.04376600f64,      0.04584267f64,      0.04800000f64,
0.05024368f64,      0.05257304f64,      0.05498056f64,      0.05745872f64,
0.06000000f64,      0.06260197f64,      0.06527752f64,      0.06804208f64,
0.07091109f64,      0.07390000f64,      0.07701600f64,      0.08026640f64,
0.08366680f64,      0.08723280f64,      0.09098000f64,      0.09491755f64,
0.09904584f64,      0.1033674f64,       0.1078846f64,       0.1126000f64,
0.1175320f64,       0.1226744f64,       0.1279928f64,       0.1334528f64,
0.1390200f64,       0.1446764f64,       0.1504693f64,       0.1564619f64,
0.1627177f64,       0.1693000f64,       0.1762431f64,       0.1835581f64,
0.1912735f64,       0.1994180f64,       0.2080200f64,       0.2171199f64,
0.2267345f64,       0.2368571f64,       0.2474812f64,       0.2586000f64,
0.2701849f64,       0.2822939f64,       0.2950505f64,       0.3085780f64,
0.3230000f64,       0.3384021f64,       0.3546858f64,       0.3716986f64,
0.3892875f64,       0.4073000f64,       0.4256299f64,       0.4443096f64,
0.4633944f64,       0.4829395f64,       0.5030000f64,       0.5235693f64,
0.5445120f64,       0.5656900f64,       0.5869653f64,       0.6082000f64,
0.6293456f64,       0.6503068f64,       0.6708752f64,       0.6908424f64,
0.7100000f64,       0.7281852f64,       0.7454636f64,       0.7619694f64,
0.7778368f64,       0.7932000f64,       0.8081104f64,       0.8224962f64,
0.8363068f64,       0.8494916f64,       0.8620000f64,       0.8738108f64,
0.8849624f64,       0.8954936f64,       0.9054432f64,       0.9148501f64,
0.9237348f64,       0.9320924f64,       0.9399226f64,       0.9472252f64,
0.9540000f64,       0.9602561f64,       0.9660074f64,       0.9712606f64,
0.9760225f64,       0.9803000f64,       0.9840924f64,       0.9874812f64,
0.9903128f64,       0.9928116f64,       0.9949501f64,       0.9967108f64,
0.9980983f64,       0.9991120f64,       0.9997482f64,       1.0000000f64,
0.9998567f64,       0.9993046f64,       0.9983255f64,       0.9968987f64,
0.9950000f64,       0.9926005f64,       0.9897426f64,       0.9864444f64,
0.9827241f64,       0.9786000f64,       0.9740837f64,       0.9691712f64,
0.9638568f64,       0.9581349f64,       0.9520000f64,       0.9454504f64,
0.9384992f64,       0.9311628f64,       0.9234576f64,       0.9154000f64,
0.9070064f64,       0.8982772f64,       0.8892048f64,       0.8797816f64,
0.8700000f64,       0.8598613f64,       0.8493920f64,       0.8386220f64,
0.8275813f64,       0.8163000f64,       0.8047947f64,       0.7930820f64,
0.7811920f64,       0.7691547f64,       0.7570000f64,       0.7447541f64,
0.7324224f64,       0.7200036f64,       0.7074965f64,       0.6949000f64,
0.6822192f64,       0.6694716f64,       0.6566744f64,       0.6438448f64,
0.6310000f64,       0.6181555f64,       0.6053144f64,       0.5924756f64,
0.5796379f64,       0.5668000f64,       0.5539611f64,       0.5411372f64,
0.5283528f64,       0.5156323f64,       0.5030000f64,       0.4904688f64,
0.4780304f64,       0.4656776f64,       0.4534032f64,       0.4412000f64,
0.4290800f64,       0.4170360f64,       0.4050320f64,       0.3930320f64,
0.3810000f64,       0.3689184f64,       0.3568272f64,       0.3447768f64,
0.3328176f64,       0.3210000f64,       0.3093381f64,       0.2978504f64,
0.2865936f64,       0.2756245f64,       0.2650000f64,       0.2547632f64,
0.2448896f64,       0.2353344f64,       0.2260528f64,       0.2170000f64,
0.2081616f64,       0.1995488f64,       0.1911552f64,       0.1829744f64,
0.1750000f64,       0.1672235f64,       0.1596464f64,       0.1522776f64,
0.1451259f64,       0.1382000f64,       0.1315003f64,       0.1250248f64,
0.1187792f64,       0.1127691f64,       0.1070000f64,       0.1014762f64,
0.09618864f64,      0.09112296f64,      0.08626485f64,      0.08160000f64,
0.07712064f64,      0.07282552f64,      0.06871008f64,      0.06476976f64,
0.06100000f64,      0.05739621f64,      0.05395504f64,      0.05067376f64,
0.04754965f64,      0.04458000f64,      0.04175872f64,      0.03908496f64,
0.03656384f64,      0.03420048f64,      0.03200000f64,      0.02996261f64,
0.02807664f64,      0.02632936f64,      0.02470805f64,      0.02320000f64,
0.02180077f64,      0.02050112f64,      0.01928108f64,      0.01812069f64,
0.01700000f64,      0.01590379f64,      0.01483718f64,      0.01381068f64,
0.01283478f64,      0.01192000f64,      0.01106831f64,      0.01027339f64,
0.009533311f64,     0.008846157f64,     0.008210000f64,     0.007623781f64,
0.007085424f64,     0.006591476f64,     0.006138485f64,     0.005723000f64,
0.005343059f64,     0.004995796f64,     0.004676404f64,     0.004380075f64,
0.004102000f64,     0.003838453f64,     0.003589099f64,     0.003354219f64,
0.003134093f64,     0.002929000f64,     0.002738139f64,     0.002559876f64,
0.002393244f64,     0.002237275f64,     0.002091000f64,     0.001953587f64,
0.001824580f64,     0.001703580f64,     0.001590187f64,     0.001484000f64,
0.001384496f64,     0.001291268f64,     0.001204092f64,     0.001122744f64,
0.001047000f64,     0.0009765896f64,    0.0009111088f64,    0.0008501332f64,
0.0007932384f64,    0.0007400000f64,    0.0006900827f64,    0.0006433100f64,
0.0005994960f64,    0.0005584547f64,    0.0005200000f64,    0.0004839136f64,
0.0004500528f64,    0.0004183452f64,    0.0003887184f64,    0.0003611000f64,
0.0003353835f64,    0.0003114404f64,    0.0002891656f64,    0.0002684539f64,
0.0002492000f64,    0.0002313019f64,    0.0002146856f64,    0.0001992884f64,
0.0001850475f64,    0.0001719000f64,    0.0001597781f64,    0.0001486044f64,
0.0001383016f64,    0.0001287925f64,    0.0001200000f64,    0.0001118595f64,
0.0001043224f64,    0.00009733560f64,   0.00009084587f64,   0.00008480000f64,
0.00007914667f64,   0.00007385800f64,   0.00006891600f64,   0.00006430267f64,
0.00006000000f64,   0.00005598187f64,   0.00005222560f64,   0.00004871840f64,
0.00004544747f64,   0.00004240000f64,   0.00003956104f64,   0.00003691512f64,
0.00003444868f64,   0.00003214816f64,   0.00003000000f64,   0.00002799125f64,
0.00002611356f64,   0.00002436024f64,   0.00002272461f64,   0.00002120000f64,
0.00001977855f64,   0.00001845285f64,   0.00001721687f64,   0.00001606459f64,
0.00001499000f64,   0.00001398728f64,   0.00001305155f64,   0.00001217818f64,
0.00001136254f64,   0.00001060000f64,   0.000009885877f64,  0.000009217304f64,
0.000008592362f64,  0.000008009133f64,  0.000007465700f64,  0.000006959567f64,
0.000006487995f64,  0.000006048699f64,  0.000005639396f64,  0.000005257800f64,
0.000004901771f64,  0.000004569720f64,  0.000004260194f64,  0.000003971739f64,
0.000003702900f64,  0.000003452163f64,  0.000003218302f64,  0.000003000300f64,
0.000002797139f64,  0.000002607800f64,  0.000002431220f64,  0.000002266531f64,
0.000002113013f64,  0.000001969943f64,  0.000001836600f64,  0.000001712230f64,
0.000001596228f64,  0.000001488090f64,  0.000001387314f64,  0.000001293400f64,
0.000001205820f64,  0.000001124143f64,  0.000001048009f64,  0.0000009770578f64,
0.0000009109300f64, 0.0000008492513f64, 0.0000007917212f64, 0.0000007380904f64,
0.0000006881098f64, 0.0000006415300f64, 0.0000005980895f64, 0.0000005575746f64,
0.0000005198080f64, 0.0000004846123f64, 0.0000004518100f64];
pub const CIE_Z: [f64; N_CIE_SAMPLES] = [
    0.0006061000f64,
    0.0006808792f64,
    0.0007651456f64,
    0.0008600124f64,
    0.0009665928f64,
    0.001086000f64,
    0.001220586f64,
    0.001372729f64,
    0.001543579f64,
    0.001734286f64,
    0.001946000f64,
    0.002177777f64,
    0.002435809f64,
    0.002731953f64,
    0.003078064f64,
    0.003486000f64,
    0.003975227f64,
    0.004540880f64,
    0.005158320f64,
    0.005802907f64,
    0.006450001f64,
    0.007083216f64,
    0.007745488f64,
    0.008501152f64,
    0.009414544f64,
    0.01054999f64,
    0.01196580f64,
    0.01365587f64,
    0.01558805f64,
    0.01773015f64,
    0.02005001f64,
    0.02251136f64,
    0.02520288f64,
    0.02827972f64,
    0.03189704f64,
    0.03621000f64,
    0.04143771f64,
    0.04750372f64,
    0.05411988f64,
    0.06099803f64,
    0.06785001f64,
    0.07448632f64,
    0.08136156f64,
    0.08915364f64,
    0.09854048f64,
    0.1102000f64,
    0.1246133f64,
    0.1417017f64,
    0.1613035f64,
    0.1832568f64,
    0.2074000f64,
    0.2336921f64,
    0.2626114f64,
    0.2947746f64,
    0.3307985f64,
    0.3713000f64,
    0.4162091f64,
    0.4654642f64,
    0.5196948f64,
    0.5795303f64,
    0.6456000f64,
    0.7184838f64,
    0.7967133f64,
    0.8778459f64,
    0.9594390f64,
    1.0390501f64,
    1.1153673f64,
    1.1884971f64,
    1.2581233f64,
    1.3239296f64,
    1.3856000f64,
    1.4426352f64,
    1.4948035f64,
    1.5421903f64,
    1.5848807f64,
    1.6229600f64,
    1.6564048f64,
    1.6852959f64,
    1.7098745f64,
    1.7303821f64,
    1.7470600f64,
    1.7600446f64,
    1.7696233f64,
    1.7762637f64,
    1.7804334f64,
    1.7826000f64,
    1.7829682f64,
    1.7816998f64,
    1.7791982f64,
    1.7758671f64,
    1.7721100f64,
    1.7682589f64,
    1.7640390f64,
    1.7589438f64,
    1.7524663f64,
    1.7441000f64,
    1.7335595f64,
    1.7208581f64,
    1.7059369f64,
    1.6887372f64,
    1.6692000f64,
    1.6475287f64,
    1.6234127f64,
    1.5960223f64,
    1.5645280f64,
    1.5281000f64,
    1.4861114f64,
    1.4395215f64,
    1.3898799f64,
    1.3387362f64,
    1.2876400f64,
    1.2374223f64,
    1.1878243f64,
    1.1387611f64,
    1.0901480f64,
    1.0419000f64,
    0.9941976f64,
    0.9473473f64,
    0.9014531f64,
    0.8566193f64,
    0.8129501f64,
    0.7705173f64,
    0.7294448f64,
    0.6899136f64,
    0.6521049f64,
    0.6162000f64,
    0.5823286f64,
    0.5504162f64,
    0.5203376f64,
    0.4919673f64,
    0.4651800f64,
    0.4399246f64,
    0.4161836f64,
    0.3938822f64,
    0.3729459f64,
    0.3533000f64,
    0.3348578f64,
    0.3175521f64,
    0.3013375f64,
    0.2861686f64,
    0.2720000f64,
    0.2588171f64,
    0.2464838f64,
    0.2347718f64,
    0.2234533f64,
    0.2123000f64,
    0.2011692f64,
    0.1901196f64,
    0.1792254f64,
    0.1685608f64,
    0.1582000f64,
    0.1481383f64,
    0.1383758f64,
    0.1289942f64,
    0.1200751f64,
    0.1117000f64,
    0.1039048f64,
    0.09666748f64,
    0.08998272f64,
    0.08384531f64,
    0.07824999f64,
    0.07320899f64,
    0.06867816f64,
    0.06456784f64,
    0.06078835f64,
    0.05725001f64,
    0.05390435f64,
    0.05074664f64,
    0.04775276f64,
    0.04489859f64,
    0.04216000f64,
    0.03950728f64,
    0.03693564f64,
    0.03445836f64,
    0.03208872f64,
    0.02984000f64,
    0.02771181f64,
    0.02569444f64,
    0.02378716f64,
    0.02198925f64,
    0.02030000f64,
    0.01871805f64,
    0.01724036f64,
    0.01586364f64,
    0.01458461f64,
    0.01340000f64,
    0.01230723f64,
    0.01130188f64,
    0.01037792f64,
    0.009529306f64,
    0.008749999f64,
    0.008035200f64,
    0.007381600f64,
    0.006785400f64,
    0.006242800f64,
    0.005749999f64,
    0.005303600f64,
    0.004899800f64,
    0.004534200f64,
    0.004202400f64,
    0.003900000f64,
    0.003623200f64,
    0.003370600f64,
    0.003141400f64,
    0.002934800f64,
    0.002749999f64,
    0.002585200f64,
    0.002438600f64,
    0.002309400f64,
    0.002196800f64,
    0.002100000f64,
    0.002017733f64,
    0.001948200f64,
    0.001889800f64,
    0.001840933f64,
    0.001800000f64,
    0.001766267f64,
    0.001737800f64,
    0.001711200f64,
    0.001683067f64,
    0.001650001f64,
    0.001610133f64,
    0.001564400f64,
    0.001513600f64,
    0.001458533f64,
    0.001400000f64,
    0.001336667f64,
    0.001270000f64,
    0.001205000f64,
    0.001146667f64,
    0.001100000f64,
    0.001068800f64,
    0.001049400f64,
    0.001035600f64,
    0.001021200f64,
    0.001000000f64,
    0.0009686400f64,
    0.0009299200f64,
    0.0008868800f64,
    0.0008425600f64,
    0.0008000000f64,
    0.0007609600f64,
    0.0007236800f64,
    0.0006859200f64,
    0.0006454400f64,
    0.0006000000f64,
    0.0005478667f64,
    0.0004916000f64,
    0.0004354000f64,
    0.0003834667f64,
    0.0003400000f64,
    0.0003072533f64,
    0.0002831600f64,
    0.0002654400f64,
    0.0002518133f64,
    0.0002400000f64,
    0.0002295467f64,
    0.0002206400f64,
    0.0002119600f64,
    0.0002021867f64,
    0.0001900000f64,
    0.0001742133f64,
    0.0001556400f64,
    0.0001359600f64,
    0.0001168533f64,
    0.0001000000f64,
    0.00008613333f64,
    0.00007460000f64,
    0.00006500000f64,
    0.00005693333f64,
    0.00004999999f64,
    0.00004416000f64,
    0.00003948000f64,
    0.00003572000f64,
    0.00003264000f64,
    0.00003000000f64,
    0.00002765333f64,
    0.00002556000f64,
    0.00002364000f64,
    0.00002181333f64,
    0.00002000000f64,
    0.00001813333f64,
    0.00001620000f64,
    0.00001420000f64,
    0.00001213333f64,
    0.00001000000f64,
    0.000007733333f64,
    0.000005400000f64,
    0.000003200000f64,
    0.000001333333f64,
    0.000000000000f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64,
    0.0f64];
pub const CIE_LAMBDA: [f64; N_CIE_SAMPLES] = [
    360f64, 361f64, 362f64, 363f64, 364f64, 365f64, 366f64, 367f64, 368f64, 369f64, 370f64, 371f64, 372f64, 373f64, 374f64,
    375f64, 376f64, 377f64, 378f64, 379f64, 380f64, 381f64, 382f64, 383f64, 384f64, 385f64, 386f64, 387f64, 388f64, 389f64,
    390f64, 391f64, 392f64, 393f64, 394f64, 395f64, 396f64, 397f64, 398f64, 399f64, 400f64, 401f64, 402f64, 403f64, 404f64,
    405f64, 406f64, 407f64, 408f64, 409f64, 410f64, 411f64, 412f64, 413f64, 414f64, 415f64, 416f64, 417f64, 418f64, 419f64,
    420f64, 421f64, 422f64, 423f64, 424f64, 425f64, 426f64, 427f64, 428f64, 429f64, 430f64, 431f64, 432f64, 433f64, 434f64,
    435f64, 436f64, 437f64, 438f64, 439f64, 440f64, 441f64, 442f64, 443f64, 444f64, 445f64, 446f64, 447f64, 448f64, 449f64,
    450f64, 451f64, 452f64, 453f64, 454f64, 455f64, 456f64, 457f64, 458f64, 459f64, 460f64, 461f64, 462f64, 463f64, 464f64,
    465f64, 466f64, 467f64, 468f64, 469f64, 470f64, 471f64, 472f64, 473f64, 474f64, 475f64, 476f64, 477f64, 478f64, 479f64,
    480f64, 481f64, 482f64, 483f64, 484f64, 485f64, 486f64, 487f64, 488f64, 489f64, 490f64, 491f64, 492f64, 493f64, 494f64,
    495f64, 496f64, 497f64, 498f64, 499f64, 500f64, 501f64, 502f64, 503f64, 504f64, 505f64, 506f64, 507f64, 508f64, 509f64,
    510f64, 511f64, 512f64, 513f64, 514f64, 515f64, 516f64, 517f64, 518f64, 519f64, 520f64, 521f64, 522f64, 523f64, 524f64,
    525f64, 526f64, 527f64, 528f64, 529f64, 530f64, 531f64, 532f64, 533f64, 534f64, 535f64, 536f64, 537f64, 538f64, 539f64,
    540f64, 541f64, 542f64, 543f64, 544f64, 545f64, 546f64, 547f64, 548f64, 549f64, 550f64, 551f64, 552f64, 553f64, 554f64,
    555f64, 556f64, 557f64, 558f64, 559f64, 560f64, 561f64, 562f64, 563f64, 564f64, 565f64, 566f64, 567f64, 568f64, 569f64,
    570f64, 571f64, 572f64, 573f64, 574f64, 575f64, 576f64, 577f64, 578f64, 579f64, 580f64, 581f64, 582f64, 583f64, 584f64,
    585f64, 586f64, 587f64, 588f64, 589f64, 590f64, 591f64, 592f64, 593f64, 594f64, 595f64, 596f64, 597f64, 598f64, 599f64,
    600f64, 601f64, 602f64, 603f64, 604f64, 605f64, 606f64, 607f64, 608f64, 609f64, 610f64, 611f64, 612f64, 613f64, 614f64,
    615f64, 616f64, 617f64, 618f64, 619f64, 620f64, 621f64, 622f64, 623f64, 624f64, 625f64, 626f64, 627f64, 628f64, 629f64,
    630f64, 631f64, 632f64, 633f64, 634f64, 635f64, 636f64, 637f64, 638f64, 639f64, 640f64, 641f64, 642f64, 643f64, 644f64,
    645f64, 646f64, 647f64, 648f64, 649f64, 650f64, 651f64, 652f64, 653f64, 654f64, 655f64, 656f64, 657f64, 658f64, 659f64,
    660f64, 661f64, 662f64, 663f64, 664f64, 665f64, 666f64, 667f64, 668f64, 669f64, 670f64, 671f64, 672f64, 673f64, 674f64,
    675f64, 676f64, 677f64, 678f64, 679f64, 680f64, 681f64, 682f64, 683f64, 684f64, 685f64, 686f64, 687f64, 688f64, 689f64,
    690f64, 691f64, 692f64, 693f64, 694f64, 695f64, 696f64, 697f64, 698f64, 699f64, 700f64, 701f64, 702f64, 703f64, 704f64,
    705f64, 706f64, 707f64, 708f64, 709f64, 710f64, 711f64, 712f64, 713f64, 714f64, 715f64, 716f64, 717f64, 718f64, 719f64,
    720f64, 721f64, 722f64, 723f64, 724f64, 725f64, 726f64, 727f64, 728f64, 729f64, 730f64, 731f64, 732f64, 733f64, 734f64,
    735f64, 736f64, 737f64, 738f64, 739f64, 740f64, 741f64, 742f64, 743f64, 744f64, 745f64, 746f64, 747f64, 748f64, 749f64,
    750f64, 751f64, 752f64, 753f64, 754f64, 755f64, 756f64, 757f64, 758f64, 759f64, 760f64, 761f64, 762f64, 763f64, 764f64,
    765f64, 766f64, 767f64, 768f64, 769f64, 770f64, 771f64, 772f64, 773f64, 774f64, 775f64, 776f64, 777f64, 778f64, 779f64,
    780f64, 781f64, 782f64, 783f64, 784f64, 785f64, 786f64, 787f64, 788f64, 789f64, 790f64, 791f64, 792f64, 793f64, 794f64,
    795f64, 796f64, 797f64, 798f64, 799f64, 800f64, 801f64, 802f64, 803f64, 804f64, 805f64, 806f64, 807f64, 808f64, 809f64,
    810f64, 811f64, 812f64, 813f64, 814f64, 815f64, 816f64, 817f64, 818f64, 819f64, 820f64, 821f64, 822f64, 823f64, 824f64,
    825f64, 826f64, 827f64, 828f64, 829f64, 830f64
]; 